using System;

namespace PersonalRecords
{
    internal class Program
    {
        static void Main(string[] args)
        {
            const string CommandAddDossier = "1";
            const string CommandOutputDossiers = "2";
            const string CommandDeleteDossier = "3";
            const string CommandSearchSurname = "4";
            const string CommandExit = "5";

            string[] recordsDossier = new string[0];
            string[] recordsPost = new string[0];
            string[] commands = { "Добавить досье", "Вывести все досье", "Удалить досье", "Поиск по фамилии", "Выход" };

            bool isRun = true;

            int direction = 0;

            while (isRun)
            {
                Console.Clear();

                direction = SelectionItemsDisplay (commands, null, direction);

                string menuItem = Convert.ToString(direction + 1);

                Console.Clear();

                switch (menuItem)
                {
                    case CommandAddDossier:
                        AddDossier(ref recordsDossier, ref recordsPost);
                        break;

                    case CommandOutputDossiers:
                        OutputDossiers(recordsDossier, recordsPost);
                        break;

                    case CommandDeleteDossier:
                        DeleteDossier(ref recordsDossier, ref recordsPost);
                        break;

                    case CommandSearchSurname:
                        SearchSurname(recordsDossier, recordsPost);
                        break;

                    case CommandExit:
                        isRun = false;
                        continue;
                }
            }
        }

        static int SelectionItemsDisplay (string[] itemsDisplay1, string[] itemsDisplay2, int direction)
        {
            direction = 0;

            ConsoleKeyInfo pressedKey = new ConsoleKeyInfo();

            while (pressedKey.Key != ConsoleKey.Enter)
            {
                for (int i = 0; i < itemsDisplay1.Length; i++)
                {
                    if (itemsDisplay1.Length == direction)
                    {
                        direction = 0;
                    }
                    else if (direction == -1)
                    {
                        direction = itemsDisplay1.Length - 1;
                    }

                    if (i == direction)
                    {
                        ConsoleColor defultColor = Console.ForegroundColor;
                        ConsoleColor defultColor2 = Console.BackgroundColor;
                        Console.BackgroundColor = ConsoleColor.Gray;
                        Console.ForegroundColor = ConsoleColor.Red;

                        if (itemsDisplay2 == null)
                        {
                            Console.WriteLine(itemsDisplay1[i]);
                        }
                        else
                        {
                            Console.WriteLine($"{i + 1}. {itemsDisplay1[i]}  -  {itemsDisplay2[i]} ");
                        }

                        Console.BackgroundColor = defultColor2;
                        Console.ForegroundColor = defultColor;
                    }
                    else
                    {
                        if (itemsDisplay2 == null)
                        {
                            Console.WriteLine(itemsDisplay1[i]);
                        }
                        else
                        {
                            Console.WriteLine($"{i + 1}. {itemsDisplay1[i]}  -  {itemsDisplay2[i]} ");
                        }
                    }
                }

                pressedKey = Console.ReadKey();
                ConsoleKey moveDownCommand = ConsoleKey.DownArrow;
                ConsoleKey moveUpCommand = ConsoleKey.UpArrow;

                if (pressedKey.Key == moveDownCommand)
                {
                    direction += 1;

                    Console.Clear();
                }
                else if (pressedKey.Key == moveUpCommand)
                {
                    direction -= 1;

                    Console.Clear();
                }
            }

            return direction;
        }

        static void AddDossier(ref string[] recordsDossier, ref string[] recordPost)
        {
            Console.WriteLine("Введите ФИО");
            recordsDossier = AddElement(recordsDossier);

            Console.WriteLine("Введите должность");
            recordPost = AddElement(recordPost);

            Console.WriteLine("Досье добавлено");

            Console.ReadKey();

            Console.Clear();
        }

        static string[] AddElement(string[] records)
        {
            string[] utilityRecords = new string[records.Length + 1];

            for (int i = 0; i < records.Length; i++)
            {
                utilityRecords[i] = records[i];
            }

            utilityRecords[utilityRecords.Length - 1] = Console.ReadLine();
            records = utilityRecords;

            return records;
        }

        static void OutputDossiers(string[] recordsDossier, string[] recordsPost)
        {
            if (recordsDossier.Length > 0)
            {
                for (int i = 0; i < recordsDossier.Length; i++)
                {
                    Console.WriteLine($"{i + 1}. {recordsDossier[i]}  -  {recordsPost[i]} ");
                }

                Console.WriteLine("\n");

                Console.ReadKey();

                Console.Clear();
            }
            else
            {
                Console.Clear();

                Console.WriteLine("Список пуст");

                Console.ReadKey();
            }
        }

        static void DeleteDossier(ref string[] recordsDossier, ref string[] recordsPost)
        {
            if (recordsDossier.Length > 0)
            {
                int direction = 0;

                direction = SelectionItemsDisplay(recordsDossier, recordsPost, direction);

                int numberDeleted = direction;

                Console.SetCursorPosition((recordsDossier[numberDeleted].Length + recordsPost[numberDeleted].Length + 10), direction);
                Console.Write(" < удалено");

                recordsDossier = DeleteElement(recordsDossier, direction);
                recordsPost = DeleteElement(recordsPost, direction);

                Console.ReadKey();

                Console.Clear();
            }
            else
            {
                Console.Clear();

                Console.WriteLine("Список пуст");

                Console.ReadKey();
            }
        }

        static string[] DeleteElement(string[] records, int numberDossier)
        {
            string[] utilityRecords = new string[records.Length - 1];

            for (int i = 0; i < numberDossier; i++)
            {
                utilityRecords[i] = records[i];
            }

            for (int i = numberDossier; i < utilityRecords.Length; i++)
            {
                utilityRecords[i] = records[i + 1];
            }

            records = utilityRecords;
            return records;
        }

        static void SearchSurname(string[] recordsDossier, string[] recordsPost)
        {
            if (recordsDossier.Length > 0)
            {
                Console.WriteLine("Введите фамилию для поиска");

                string surnameFind = Console.ReadLine();

                for (int i = 0; i < recordsDossier.Length; i++)
                {
                    if (recordsDossier[i].ToLower().StartsWith(surnameFind.ToLower()))
                        Console.WriteLine($"{recordsDossier[i]} - {recordsPost[i]}");
                }

                Console.ReadKey();
            }
            else
            {
                Console.Clear();

                Console.WriteLine("Список пуст");

                Console.ReadKey();
            }
        }
    }
}
